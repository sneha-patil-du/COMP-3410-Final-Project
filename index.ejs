<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Helper</title>
    <style>
      #displayedCode {
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        padding: 10px;
        margin-top: 15px;
        white-space: pre-wrap; /* Ensures code formatting */
      }
    </style>
</head>
<body>

<!-- Code Submission Form -->
<section id="codeSubmission">
    <h2>Submit Your Code</h2>
    <form id="codeForm">
      <textarea id="codeSnippet" placeholder="Paste your code here..." required></textarea>
      <button type="submit">Submit Code</button>
    </form>
    <div id="submissionMessage"></div> <!-- Confirmation message will appear here -->
    <div id="displayedCode"></div> <!-- Submitted code will appear here -->
  </section>
<!-- ... same as before -->
<div id="submittedCode"></div>

<!-- Similar Repositories Placeholder -->
<section id="similarRepos">
    <h2>Similar Repositories</h2>
    <div id="repositories">Similar repositories from GitHub will be listed here.</div>
  </section>

<!-- Comments Section Placeholder -->
<section id="comments">
    <h2>Comments</h2>
    <div id="commentSection">User comments will appear here.</div>
    <!-- Comment Form -->
    <form id="commentForm">
      <textarea id="comment" placeholder="Leave a comment..." required></textarea>
      <button type="submit">Post Comment</button>
    </form>
  </section>

  <script>
    document.getElementById('codeForm').addEventListener('submit', function(e) {
      e.preventDefault();
  
      var codeSnippet = document.getElementById('codeSnippet').value;
      
      // Display a confirmation message
      document.getElementById('submissionMessage').textContent = 'Your code has been submitted successfully!';
  
      // Display the submitted code in a code box
      document.getElementById('displayedCode').innerHTML = '<pre>' + codeSnippet + '</pre>';
      
      // Use `fetch` to send the code to your server
      // Use `fetch` to send the code to your server and handle the response
  fetch('/submit-code', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ codeSnippet: codeSnippet })
    })
    .then(response => response.json())
    .then(data => {
      console.log(data); // Log the data received
      const reposContainer = document.getElementById('repositories');
      reposContainer.innerHTML = ''; // Clear previous results

      if (data.similarRepos && data.similarRepos.length > 0) {
        // Process and display each repository
        data.similarRepos.forEach(repo => {
          const repoElement = document.createElement('div');
          repoElement.innerHTML = `<a href="${repo.html_url}" target="_blank">${repo.full_name}</a>`;
          reposContainer.appendChild(repoElement);
        });
      } else {
        reposContainer.innerHTML = '<p>No similar repositories found.</p>';
      }
    })
    .catch((error) => {
      console.error('Error:', error);
    });
  });
  </script>

  
  <script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();

  document.getElementById('commentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const commentText = document.getElementById('comment').value;
    const snippetId = document.getElementById('displayedCode').getAttribute('data-snippet-id');

    socket.emit('comment', { comment: commentText, snippetId: snippetId });
    document.getElementById('comment').value = '';
  });

  // Handle incoming comments
  socket.on('comment', (commentText) => {
    const commentSection = document.getElementById('commentSection');
    commentSection.innerHTML += `<p>${commentText}</p>`; // Append comment
  });

</script>
</body>
</html>


